# 动态代理模式

[视频](https://www.bilibili.com/video/BV1ue411N7GX/)

```java
// Star.interface
public interface Star {
    public String sing(String name);
    public void dance();
}
// BigStar.java
public class BigStar implements Star{
    private String name;
    public BigStar(String name) {
        this.name = name;
    }
    public String sing(String name){
        System.out.println(this.name+" is sing a song called " + name);
        return "Thank you!";
    }
    public void dance(){
        System.out.println(this.name+" is dancing" );
    }
}
// ProxyUtil.java
public class ProxyUtil {
    public static Star createProxy(BigStar bigStar){
        Star starProxy = (Star)Proxy.newProxyInstance(
//                ClassLoader loader,
//                Class<?>[] interfaces,
//                InvocationHandler h
                ProxyUtil.class.getClassLoader(),
                new Class[]{Star.class},
                new InvocationHandler() {
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        if(method.getName().equals("sing")){
                            System.out.println("pay 20$");
                        }
                        else if(method.getName().equals("dance")){
                            System.out.println("pay 100$");
                        }
                        return method.invoke(bigStar, args);
                    }
                }
        );
        return starProxy;
    }
}
// Main.java
public class Main {
    public static void main(String[] args) {
        BigStar s = new BigStar("杨超越");
        Star starProxy =  ProxyUtil.createProxy(s);
        String thx = starProxy.sing("好日子");
        System.out.println(thx);
        starProxy.dance();
    }
}
```